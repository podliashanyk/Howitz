<div id="update-event-status-modal"
     class="fixed inset-0 z-50 flex flex-col items-center justify-center"
     aria-labelledby="modal-title"
     role="dialog"
     aria-modal="true"
>
    <div
            class="modal-underlay inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
            hx-get="/events/{{ id }}/hide_details"
            hx-target="#update-event-status-modal"
            hx-swap="delete"
    ></div>

    <div class="flex items-end justify-center p-4 text-center sm:items-center sm:p-0">

        <div class="relative transform overflow-x-hidden overflow-y-auto rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 w-fit sm:w-full sm:max-w-3xl">
            <div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
                <div class="sm:flex sm:items-start">
                    <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
                        <h3 class="text-base font-semibold leading-6 text-gray-900" id="modal-title">Update
                            event
                            #{{ id }}</h3>
                        <div class="mt-2">

                            <div class="basis-0 grow max-h-96 overflow-y-scroll overflow-x-auto p-5 bg-white border border-gray-200 rounded-lg shadow sm:px-12 sm:py-10 dark:bg-gray-800 dark:border-gray-700">
                                <div class="flex justify-between mb-4">
                                    <h5 class="text-center text-xl font-bold leading-none text-gray-900 dark:text-white">
                                        Logs & History</h5>
                                </div>
                                <div class="flow-root">

                                    <ul
                                            id="ol-event-{{ id }}"
                                            class="relative border-l border-gray-200 dark:border-gray-700">

                                        {% if event_msgs|length>0 %}

                                        {% for msg in event_msgs %}


                                        <li class="mb-10 ml-4">

                                            <div class="absolute w-3 h-3  rounded-full mt-1.5 -left-1.5 border border-white dark:border-gray-900 {% if msg.user %} bg-orange-950 dark:bg-orange-400 {% else %} bg-blue-950 dark:bg-blue-400 {% endif %}"></div>
                                            <h3 class="mb-1 text-sm font-normal leading-none text-gray-400 dark:text-gray-500">
                                                {{ msg.user }}
                                            </h3>
                                            <time class="text-lg font-semibold text-gray-900 dark:text-white">
                                                {{
                                                msg.date }}
                                            </time>
                                            <p class="mb-4 text-base font-normal text-gray-500 dark:text-gray-400">
                                                {{ msg.log }}</p>
                                        </li>


                                        {% endfor %}

                                        {% endif %}

                                        <li
                                                id="update-event-form-{{ id }}"
                                                class="mb-10 ml-4">
                                            <div class="absolute w-3 h-3 bg-white rounded-full mt-1.5 -left-1.5 border border-white dark:border-gray-900"></div>


                                            <div

                                            >
                                                <div class="flex justify-between items-center mb-6">
                                                    <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                                                        Update event
                                                        (#{{ id }})</h3>
                                                </div>
                                                <form class="mb-6 space-y-5">

                                                    <div class="text-base w-1/6">
                                                        <label
                                                                for="event-state"
                                                                class="block mb-2 font-medium text-gray-900 dark:text-white">
                                                            Select state
                                                        </label>
                                                        <select id="event-state"
                                                                name="event-state"
                                                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                                                            <option class="px-2" value="open" {% if
                                                                    current_state=='open'
                                                                    %}selected{% endif %}>Open
                                                            </option>
                                                            <option class="mx-2" value="working" {% if
                                                                    current_state=='working'
                                                                    %}selected{% endif %}>Working
                                                            </option>
                                                            <option value="waiting" {% if
                                                                    current_state=='waiting'
                                                                    %}selected{%
                                                                    endif %}>Waiting
                                                            </option>
                                                            <option value="confirm-wait" {% if
                                                                    current_state=='confirm-wait'
                                                                    %}selected{% endif %}>Confirm
                                                            </option>
                                                            <option value="ignored" {% if
                                                                    current_state=='ignored'
                                                                    %}selected{%
                                                                    endif %}>Ignored
                                                            </option>
                                                            <option value="closed" {% if
                                                                    current_state=='closed'
                                                                    %}selected{%
                                                                    endif %}>Closed
                                                            </option>
                                                        </select>
                                                    </div>

                                                    <div class="w-3/4 py-2 px-4 mb-4 bg-white rounded-lg rounded-t-lg border border-gray-200 dark:bg-gray-800 dark:border-gray-700">
                                                        <label for="comment" class="sr-only">Your
                                                            comment</label>
                                                        <textarea id="comment" rows="4"
                                                                  name="event-history"
                                                                  class="px-0 w-full text-base text-gray-900 border-0 focus:ring-0 focus:outline-none dark:text-white dark:placeholder-gray-400 dark:bg-gray-800"
                                                                  placeholder="Add a message to history..."></textarea>
                                                    </div>

                                                    <button
                                                            hx-post="/event/{{ id }}/update_status"
                                                            hx-target="#event-table-row-{{ id }}"
                                                            hx-swap="outerHTML"
                                                            class="mr-1 inline-flex items-center py-2.5 px-4 font-medium text-center text-white bg-primary-700 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-800 bg-blue-700 hover:bg-blue-800 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">
                                                        Update event
                                                    </button>

                                                </form>

                                            </div>
                                        </li>

                                    </ul>

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
                <!--                    <button-->
                <!--                            type="submit"-->
                <!--                            hx-post="/event/{{ id }}/update_status"-->
                <!--                            hx-target="#event-table-row-{{ id }}"-->
                <!--                            hx-swap="outerHTML"-->
                <!--                            class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">-->
                <!--                        Update-->
                <!--                    </button>-->
                <button
                        hx-get="/events/{{ id }}/hide_details"
                        hx-target="#update-event-status-modal"
                        hx-swap="delete"
                        class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">
                    Close
                </button>
            </div>
        </div>
    </div>

</div>